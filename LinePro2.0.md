# 支付

接入企业版支付宝



# 账户

add 评价配额 

add 发货地址

del 店铺ID

Level1 普通会员

Level2 认证会员

有效期30天可叠加

每次充值500  有效期加30，评价配额加25

add 姓名、身份证号、身份证图片

 可以更改，但是第一次充值变认证会员必须完善信息，否则不给充值



# 刷单

其他属性隐藏，现在明确需要

asin、亚马逊产品url、亚马逊产品图片url、亚马逊产品title，店铺的id、包含运费的单价-美元、购买件数、送货地址、状态(正在找寻代购账号...购买中…购买完成)、创建时间、更新时间

新增任务结果记录表

刷单任务id、asin、店铺id、亚马逊账号邮箱、亚马逊订单号、亚马逊物流供应商、亚马逊物流单号、订单状态(购买中，购买完成，正在准备发货，已经发货，已经送达，订单完成可评价，正在尝试评价，评价失败，评价成功)、评价星级、评价标题、评价正文



## 刷单列表展示

刷单任务 改名 已购买商品列表

其实展示的事刷单结果表

list [asin、time、status]

Thead :亚马逊产品图片url、亚马逊产品title，店铺的id (三者点击到亚马逊产品url)、亚马逊账号邮箱、亚马逊订单号、亚马逊物流供应商、亚马逊物流单号、订单状态

订单：完成可评价 有按钮可以点击

可以输入评价星级、标题、正文

评价条件：

普通账号

认证账号





整体新版本改动除了支付宝之外改动并不大，甚至还有不少简化，不是在原来平台的基础上开发，而是fork一份，全新开发这样。原来的一期平台后续可能还会增加新东西。


平台二期改动：
1：接入企业版支付宝
支付的时候，还是直接扣余额
新建的充值订单，接入企业支付宝，不需要输入 姓名 手机 流水号之类的了
企业账号登陆信息：
lupengye@yahoo.cn 2009dago888

2：账号信息相关修改
a）账号新增评价配额属性
b）账号注册时，无需提供店铺ID了。新增发货地址属性。
c）账号分为普通会员与认证会员
d）用户主动升级账号等级功能
普通会员可以通过充值500元，升级为认证会员，有效期30天（充值之日起，包含当日），到期后自动降级为普通会员。
允许还处于认证会员状态的账号，再充值500元，有效期再加30天。
在每次账号充值500的时候，评价配额+25
e）用户完善个人信息功能
账号增加姓名，身份证号码，身份证图片三个属性
账号可以随时进行个人信息完善，但不是必须的。只验证身份证号码是否合规
一个账号，第一次由普通会员变为认证会员，充值前，必须先完善个人信息

3：刷单任务属性变化
以前记录了很多的属性，现在只需要记录 asin，亚马逊产品详情页URL，亚马逊产品图片URL，亚马逊产品Title，店铺ID，包含运费的单价（美元），购买件数，送货地址，状态，创建时间，更新时间。 其他的属性可以隐藏起来，先不使用
状态包括（正在找寻代购账号...购买中…购买完成）
以前刷单任务的结果记录在 亚马逊orderid，亚马逊物流供应商，亚马逊物流单号三个字段。现在去除这三个字段
结果记录在一张新表。 比如说刷asin1，购买件数为100，那么这个刷单任务的结果，就会在这张表有100条记录。主键是刷单任务ID和序号，可以把asin和店铺ID冗余在这张表，其他字段还包含亚马逊账号邮箱，亚马逊orderid，亚马逊物流供应商，亚马逊物流单号，订单状态（购买中，购买完成，正在准备发货，已经发货，已经送达，订单完成可评价，正在尝试评价，评价失败，评价成功），评价星级，评价标题，评价正文。
4：刷单任务列表展示方式变化 整体类似淘宝的个人订单页
不叫刷单任务啦，叫已购买商品列表，刷单任务直接展示刷单结果表
需要按照asin，时间，状态来提供筛选和分页
列表页要展示商品的图片，title，店铺ID（这三个点击都跳转到亚马逊商品详情URL），亚马逊代购账号邮箱，orderid，物流信息，更新时间，状态
若订单状态为 订单完成可评价，且订单状态是 还未评价， 则enable一个评价按钮，点击会让用户输入评价的星级，标题，正文。提价评价后，服务端调用一个评价判定函数，若函数返回true，则允许评价，并修改订单状态为 正在尝试评价。否则弹出不允许评价以及相应说明
评价判定函数：
若账号是普通账号，则，检查目标asin，若系统里已经有用户评价过该asin，则不允许评价，提示用户升级为认证会员。若系统里没有用户评价过该asin，则允许评价。 如何判定系统里是否有用户评价过该asin（存在该asin的订单结果表中，状态为（正在尝试评价，评价失败，评价成功）的记录）
若账号是认证账号，若评价配额>0，允许评价，评价配额-1.若评价配额=0，不允许评价，提示用户评价配额不足，需要充值

5：可以看到评价任务已经被吸收到刷单任务里了，评价任务相关的功能和入口都先隐藏
6：现有刷单任务提交的功能隐藏起来
7：新增一个刷单任务提交的表单，只有asin，亚马逊产品详情页URL，亚马逊产品图片URL，亚马逊产品Title，店铺ID，包含运费的单价（美元），购买件数，送货地址。几个属性
其中，asin，亚马逊产品详情页URL，亚马逊产品图片URL，亚马逊产品Title，店铺ID，包含运费的单价（美元），这结果属性是只读的。那么如何设置初值呢？
该提交页面需要支持带get参数。 
例如： xxx/addTask?asin=xxx&detailUrl=xxx&picUrl=xxx&title=xxx&shopId=xxx&totalPrice=xxx
这个页面需要获取url中的这些值，并填入，设置为readonly，只让用户输入购买件数，送货地址
送货地址是个select 一个是 用户注册时候填入的地址，一个是 “美国转运仓”

9：扣费方式变化：
a）没有了评价任务，评价不收费
b）刷单任务价格   （包含运费的单价*ceil（汇率） * 购买件数）+ （服务费 * 购买件数）。 若汇率为 6.76， 则ceil（6.76）为6.8，未规避汇率风险。需要从配置文件中读取当前汇率
d）服务费标准
普通会员    2元 + 运费20元 （若选择了美国转运仓，则有运费，否则无）
认证会员    1.5元 + 运费15元 （若选择了美国转运仓，则有运费，否则无）


服务费，配额参数，认证会员的费用，汇率，运费，会员有效天数等都需要可配置

